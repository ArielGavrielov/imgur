!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var o in r)("object"==typeof exports?exports:e)[o]=r[o]}}(global,(function(){return(()=>{"use strict";var e={907:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAlbum=void 0;const o=r(80),s=r(571);t.getAlbum=async function(e,t){const r=`${o.ALBUM_ENDPOINT}/${t}`;return s.getImgurApiResponseFromResponse(await e.request({url:r}))}},639:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),r(780).__exportStar(r(907),t)},934:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImgurClient=void 0;const o=r(780),s=r(614),a=r(894),n=r(176),i=r(788),u=r(639),l=r(80),c="imgur/next (https://github.com/kaimallea/node-imgur)",d=o.__importDefault(r(376));class p extends s.EventEmitter{constructor(e){super(),this.credentials=e,this.plainFetcher=d.default.create({baseURL:l.IMGUR_API_PREFIX,headers:{"user-agent":c},responseType:"json"}),this.fetcher=d.default.create({baseURL:l.IMGUR_API_PREFIX,headers:{"user-agent":c},responseType:"json"}),this.fetcher.interceptors.request.use((async e=>(e.headers=e.headers?e.headers:{},e.headers.authorization=await a.getAuthorizationHeader(this),e)),(e=>Promise.reject(e)))}plainRequest(e){return this.plainFetcher(e)}request(e={}){return this.fetcher(e)}deleteImage(e){return n.deleteImage(this,e)}favoriteImage(e){return n.favoriteImage(this,e)}getAlbum(e){return u.getAlbum(this,e)}getGallery(e){return i.getGallery(this,e)}getSubredditGallery(e){return i.getSubredditGallery(this,e)}searchGallery(e){return i.searchGallery(this,e)}getImage(e){return n.getImage(this,e)}updateImage(e){return n.updateImage(this,e)}upload(e){return n.upload(this,e)}}t.ImgurClient=p},80:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SEARCH_GALLERY_ENDPOINT=t.SUBREDDIT_GALLERY_ENDPOINT=t.GALLERY_ENDPOINT=t.UPLOAD_ENDPOINT=t.IMAGE_ENDPOINT=t.ALBUM_ENDPOINT=t.AUTHORIZE_ENDPOINT=t.API_VERSION=t.IMGUR_API_PREFIX=void 0,t.IMGUR_API_PREFIX="https://api.imgur.com",t.API_VERSION="3",t.AUTHORIZE_ENDPOINT="oauth2/authorize",t.ALBUM_ENDPOINT=`${t.API_VERSION}/album`,t.IMAGE_ENDPOINT=`${t.API_VERSION}/image`,t.UPLOAD_ENDPOINT=`${t.API_VERSION}/upload`,t.GALLERY_ENDPOINT=`${t.API_VERSION}/gallery`,t.SUBREDDIT_GALLERY_ENDPOINT=`${t.API_VERSION}/gallery/r`,t.SEARCH_GALLERY_ENDPOINT=`${t.API_VERSION}/gallery/search`},419:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isLogin=t.isClientId=t.isAccessToken=void 0,t.isAccessToken=function(e){return void 0!==e.accessToken},t.isClientId=function(e){return void 0!==e.clientId},t.isLogin=function(e){return void 0!==e.clientId&&void 0!==e.username&&void 0!==e.password}},571:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImgurApiResponseFromResponse=t.createForm=t.getSource=t.isStream=t.isImageUrl=t.isBase64=void 0;const o=r(780).__importDefault(r(353));function s(e){return"string"!=typeof e&&void 0!==e.base64&&"base64"===e.type}function a(e){return"string"!=typeof e&&void 0!==e.stream}t.isBase64=s,t.isImageUrl=function(e){return"string"==typeof e||void 0!==e.image&&"url"===e.type},t.isStream=a,t.getSource=function(e){return"string"==typeof e?e:s(e)?"payload.base64":a(e)?"payload.stream":e.image},t.createForm=function(e){const t=new o.default;if("string"==typeof e)return t.append("image",e),t;for(const[r,o]of Object.entries(e)){const s=["base64","stream"];-1!==s.indexOf(r)?-1!==s.indexOf(e.type)?t.append(r,e):"url"===e.type&&t.append(r,o):t.append(r,o)}return t},t.getImgurApiResponseFromResponse=function(e){var t,r;return void 0!==(null===(t=e.data)||void 0===t?void 0:t.status)&&void 0!==(null===(r=e.data)||void 0===r?void 0:r.success)?e.data:{data:e.data,status:e.status,success:!0}}},818:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getGallery=t.constructGalleryUrl=void 0;const o=r(80),s=r(835),a=r(571),n={section:"hot",sort:"viral"};function i(e){const t=Object.assign({},n,e);let r=`${t.section}`;t.sort&&(r+=`/${t.sort}`),"top"===t.section&&t.window&&(r+=`/${t.window}`),t.page&&(r+=`/${t.page}`);const a=new s.URL(`${o.IMGUR_API_PREFIX}/${o.GALLERY_ENDPOINT}/${r}`);return void 0!==t.showViral&&a.searchParams.append("showViral",t.showViral.toString()),void 0!==t.mature&&a.searchParams.append("mature",t.mature.toString()),void 0!==t.album_previews&&a.searchParams.append("album_previews",t.album_previews.toString()),a}t.constructGalleryUrl=i,t.getGallery=async function(e,t=n){const{pathname:r}=i(t),o=r.slice(1);return a.getImgurApiResponseFromResponse(await e.request({url:o}))}},686:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSubredditGallery=t.constructSubredditGalleryUrl=void 0;const o=r(80),s=r(835),a=r(571);function n(e){let t=`${e.subreddit}`;return e.sort&&(t+=`/${e.sort}`),"top"===e.sort&&e.window&&(t+=`/${e.window}`),e.page&&(t+=`/${e.page}`),new s.URL(`${o.IMGUR_API_PREFIX}/${o.SUBREDDIT_GALLERY_ENDPOINT}/${t}`)}t.constructSubredditGalleryUrl=n,t.getSubredditGallery=async function(e,t){const{pathname:r}=n(t),o=r.slice(1);return a.getImgurApiResponseFromResponse(await e.request({url:o}))}},788:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(780);o.__exportStar(r(818),t),o.__exportStar(r(686),t),o.__exportStar(r(477),t)},477:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.searchGallery=t.constructSearchGalleryUrl=void 0;const o=r(80),s=r(571),a=r(835),n=["q_all","q_any","q_exactly","q_not","q_type","q_size_px"];function i(e){let t="";e.sort&&(t+=`/${e.sort}`),"top"===e.sort&&e.window&&(t+=`/${e.window}`),e.page&&(t+=`/${e.page}`);const r=new a.URL(`${o.IMGUR_API_PREFIX}/${o.SEARCH_GALLERY_ENDPOINT}${t}`);if(n.forEach((t=>{var o;(null===(o=e[t])||void 0===o?void 0:o.length)&&r.searchParams.append(t,e[t])})),!r.search){const t=e.q||e.query;if(!t)throw new Error("No query was provided");r.searchParams.append("q",t)}return r}t.constructSearchGalleryUrl=i,t.searchGallery=async function(e,t){const{pathname:r}=i(t),o=r.slice(1);return s.getImgurApiResponseFromResponse(await e.request({url:o}))}},894:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getAuthorizationHeader=void 0;const o=r(419),s=r(80);t.getAuthorizationHeader=async function(e){if(o.isAccessToken(e.credentials))return`Bearer ${e.credentials.accessToken}`;if(o.isClientId(e.credentials)&&!o.isLogin(e.credentials))return`Client-ID ${e.credentials.clientId}`;const{clientId:t,username:r,password:a}=e.credentials,n={url:s.AUTHORIZE_ENDPOINT,baseURL:s.IMGUR_API_PREFIX,params:{client_id:t,response_type:"token"}};let i=await e.plainRequest(n);const u=Array.isArray(i.headers["set-cookie"])?i.headers["set-cookie"][0]:i.headers["set-cookie"];if(!u)throw new Error("No cookies were set during authorization");const l=u.match("(^|;)[s]*authorize_token=([^;]*)");if(!l||l.length<3)throw new Error("Unable to find authorize_token cookie");const c=l[2];n.method="POST",n.data={username:r,password:a,allow:c},n.followRedirect=!1,n.headers={cookie:`authorize_token=${c}`},i=await e.plainRequest(n);const d=i.headers.location;if(!d)throw new Error("Unable to parse location");const p=JSON.parse('{"'+decodeURI(d.slice(d.indexOf("#")+1)).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}').access_token;return e.credentials.accessToken=p,`Bearer ${p}`}},870:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteImage=void 0;const o=r(80),s=r(571);t.deleteImage=async function(e,t){const r=`${o.IMAGE_ENDPOINT}/${t}`;return s.getImgurApiResponseFromResponse(await e.request({url:r,method:"DELETE"}))}},129:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.favoriteImage=void 0;const o=r(80),s=r(571);t.favoriteImage=async function(e,t){const r=`${o.IMAGE_ENDPOINT}/${t}/favorite`;return s.getImgurApiResponseFromResponse(await e.request({url:r,method:"POST"}))}},455:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getImage=void 0;const o=r(80),s=r(571);t.getImage=async function(e,t){const r=`${o.IMAGE_ENDPOINT}/${t}`;return s.getImgurApiResponseFromResponse(await e.request({url:r}))}},176:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});const o=r(780);o.__exportStar(r(870),t),o.__exportStar(r(129),t),o.__exportStar(r(455),t),o.__exportStar(r(831),t),o.__exportStar(r(328),t)},831:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateImage=void 0;const o=r(80),s=r(571);function a(e){return"string"==typeof e.title||"string"==typeof e.description}t.updateImage=async function(e,t){if(Array.isArray(t)){const r=t.map((t=>{if(!a(t))throw new Error("Update requires a title and/or description");const r=`${o.IMAGE_ENDPOINT}/${t.imageHash}`,n=s.createForm(t);return new Promise((async function(t){return t(s.getImgurApiResponseFromResponse(await e.request({url:r,method:"POST",data:n})))}))}));return await Promise.all(r)}if(!a(t))throw new Error("Update requires a title and/or description");const r=`${o.IMAGE_ENDPOINT}/${t.imageHash}`,n=s.createForm(t);return s.getImgurApiResponseFromResponse(await e.request({url:r,method:"POST",data:n}))}},328:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.upload=void 0;const o=r(571),s=r(80);t.upload=async function(e,t){if(Array.isArray(t)){const r=t.map((t=>{const r=o.createForm(t);return new Promise((async t=>{t(o.getImgurApiResponseFromResponse(await e.request({url:s.UPLOAD_ENDPOINT,method:"POST",data:r,onUploadProgress:t=>{console.log({progressEvent:t}),e.emit("uploadProgress",{...t})}})))}))}));return await Promise.all(r)}const r=o.createForm(t),a=await e.request({url:s.UPLOAD_ENDPOINT,method:"POST",data:r,onUploadProgress:t=>{console.log({progressEvent:t}),e.emit("uploadProgress",{...t})}});return Promise.resolve(o.getImgurApiResponseFromResponse(a))}},376:e=>{e.exports=require("axios")},614:e=>{e.exports=require("events")},353:e=>{e.exports=require("form-data")},780:e=>{e.exports=require("tslib")},835:e=>{e.exports=require("url")}},t={};function r(o){var s=t[o];if(void 0!==s)return s.exports;var a=t[o]={exports:{}};return e[o](a,a.exports,r),a.exports}var o={};return(()=>{var e=o;Object.defineProperty(e,"__esModule",{value:!0}),e.ImgurClient=void 0;const t=r(934);var s=r(934);Object.defineProperty(e,"ImgurClient",{enumerable:!0,get:function(){return s.ImgurClient}}),e.default=t.ImgurClient})(),o})()}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbWd1ci93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvYWxidW0vZ2V0QWxidW0udHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvYWxidW0vaW5kZXgudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvY2xpZW50LnRzIiwid2VicGFjazovL2ltZ3VyLy4vc3JjL2NvbW1vbi9lbmRwb2ludHMudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvY29tbW9uL3R5cGVzLnRzIiwid2VicGFjazovL2ltZ3VyLy4vc3JjL2NvbW1vbi91dGlscy50cyIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9nYWxsZXJ5L2dldEdhbGxlcnkudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvZ2FsbGVyeS9nZXRTdWJyZWRkaXRHYWxsZXJ5LnRzIiwid2VicGFjazovL2ltZ3VyLy4vc3JjL2dhbGxlcnkvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvZ2FsbGVyeS9zZWFyY2hHYWxsZXJ5LnRzIiwid2VicGFjazovL2ltZ3VyLy4vc3JjL2dldEF1dGhvcml6YXRpb25IZWFkZXIudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvaW1hZ2UvZGVsZXRlSW1hZ2UudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvLi9zcmMvaW1hZ2UvZmF2b3JpdGVJbWFnZS50cyIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9pbWFnZS9nZXRJbWFnZS50cyIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9pbWFnZS9pbmRleC50cyIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9pbWFnZS91cGRhdGVJbWFnZS50cyIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9pbWFnZS91cGxvYWQudHMiLCJ3ZWJwYWNrOi8vaW1ndXIvZXh0ZXJuYWwgXCJheGlvc1wiIiwid2VicGFjazovL2ltZ3VyL2V4dGVybmFsIFwiZXZlbnRzXCIiLCJ3ZWJwYWNrOi8vaW1ndXIvZXh0ZXJuYWwgXCJmb3JtLWRhdGFcIiIsIndlYnBhY2s6Ly9pbWd1ci9leHRlcm5hbCBcInRzbGliXCIiLCJ3ZWJwYWNrOi8vaW1ndXIvZXh0ZXJuYWwgXCJ1cmxcIiIsIndlYnBhY2s6Ly9pbWd1ci93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9pbWd1ci8uL3NyYy9pbmRleC50cyJdLCJuYW1lcyI6WyJyb290IiwiZmFjdG9yeSIsImV4cG9ydHMiLCJtb2R1bGUiLCJkZWZpbmUiLCJhbWQiLCJhIiwiaSIsImdsb2JhbCIsImFzeW5jIiwiY2xpZW50IiwiYWxidW1IYXNoIiwidXJsIiwiQUxCVU1fRU5EUE9JTlQiLCJnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlIiwicmVxdWVzdCIsIlVTRVJBR0VOVCIsIkltZ3VyQ2xpZW50IiwiRXZlbnRFbWl0dGVyIiwiY3JlZGVudGlhbHMiLCJzdXBlciIsInRoaXMiLCJwbGFpbkZldGNoZXIiLCJjcmVhdGUiLCJiYXNlVVJMIiwiSU1HVVJfQVBJX1BSRUZJWCIsImhlYWRlcnMiLCJyZXNwb25zZVR5cGUiLCJmZXRjaGVyIiwiaW50ZXJjZXB0b3JzIiwidXNlIiwiY29uZmlnIiwiYXV0aG9yaXphdGlvbiIsImdldEF1dGhvcml6YXRpb25IZWFkZXIiLCJlIiwiUHJvbWlzZSIsInJlamVjdCIsIm9wdGlvbnMiLCJpbWFnZUhhc2giLCJkZWxldGVJbWFnZSIsImZhdm9yaXRlSW1hZ2UiLCJnZXRBbGJ1bSIsImdldEdhbGxlcnkiLCJnZXRTdWJyZWRkaXRHYWxsZXJ5Iiwic2VhcmNoR2FsbGVyeSIsImdldEltYWdlIiwicGF5bG9hZCIsInVwZGF0ZUltYWdlIiwidXBsb2FkIiwiQVBJX1ZFUlNJT04iLCJBVVRIT1JJWkVfRU5EUE9JTlQiLCJJTUFHRV9FTkRQT0lOVCIsIlVQTE9BRF9FTkRQT0lOVCIsIkdBTExFUllfRU5EUE9JTlQiLCJTVUJSRURESVRfR0FMTEVSWV9FTkRQT0lOVCIsIlNFQVJDSF9HQUxMRVJZX0VORFBPSU5UIiwiYXJnIiwidW5kZWZpbmVkIiwiYWNjZXNzVG9rZW4iLCJjbGllbnRJZCIsInVzZXJuYW1lIiwicGFzc3dvcmQiLCJpc0Jhc2U2NCIsImJhc2U2NCIsInR5cGUiLCJpc1N0cmVhbSIsInN0cmVhbSIsImltYWdlIiwiZm9ybSIsImFwcGVuZCIsImtleSIsInZhbHVlIiwiT2JqZWN0IiwiZW50cmllcyIsInN1cHBvcnRlZFVwbG9hZE9iamVjdFR5cGVzIiwiaW5kZXhPZiIsInJlc3BvbnNlIiwiZGF0YSIsInN0YXR1cyIsInN1Y2Nlc3MiLCJkZWZhdWx0T3B0aW9ucyIsInNlY3Rpb24iLCJzb3J0IiwiY29uc3RydWN0R2FsbGVyeVVybCIsIm1lcmdlZE9wdGlvbnMiLCJhc3NpZ24iLCJ1cmkiLCJ3aW5kb3ciLCJwYWdlIiwiVVJMIiwic2hvd1ZpcmFsIiwic2VhcmNoUGFyYW1zIiwidG9TdHJpbmciLCJtYXR1cmUiLCJhbGJ1bV9wcmV2aWV3cyIsInBhdGhuYW1lIiwiZmluYWxQYXRobmFtZSIsInNsaWNlIiwiY29uc3RydWN0U3VicmVkZGl0R2FsbGVyeVVybCIsInN1YnJlZGRpdCIsImFkdmFuY2VkUGFyYW1ldGVycyIsImNvbnN0cnVjdFNlYXJjaEdhbGxlcnlVcmwiLCJmb3JFYWNoIiwicGFyYW0iLCJsZW5ndGgiLCJzZWFyY2giLCJxdWVyeSIsInEiLCJFcnJvciIsImlzQWNjZXNzVG9rZW4iLCJpc0NsaWVudElkIiwiaXNMb2dpbiIsInBhcmFtcyIsImNsaWVudF9pZCIsInJlc3BvbnNlX3R5cGUiLCJwbGFpblJlcXVlc3QiLCJjb29raWVzIiwiQXJyYXkiLCJpc0FycmF5IiwibWF0Y2hlcyIsIm1hdGNoIiwiYXV0aG9yaXplVG9rZW4iLCJtZXRob2QiLCJhbGxvdyIsImZvbGxvd1JlZGlyZWN0IiwiY29va2llIiwibG9jYXRpb24iLCJKU09OIiwicGFyc2UiLCJkZWNvZGVVUkkiLCJyZXBsYWNlIiwiYWNjZXNzX3Rva2VuIiwiaXNWYWxpZFVwZGF0ZVBheWxvYWQiLCJwIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInByb21pc2VzIiwibWFwIiwiY3JlYXRlRm9ybSIsInJlc29sdmUiLCJhbGwiLCJvblVwbG9hZFByb2dyZXNzIiwicHJvZ3Jlc3NFdmVudCIsImNvbnNvbGUiLCJsb2ciLCJlbWl0IiwicmVxdWlyZSIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iXSwibWFwcGluZ3MiOiJDQUFBLFNBQTJDQSxFQUFNQyxHQUNoRCxHQUFzQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxTQUNiLEdBQXFCLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sR0FBSUgsT0FDUCxDQUNKLElBQUlLLEVBQUlMLElBQ1IsSUFBSSxJQUFJTSxLQUFLRCxHQUF1QixpQkFBWkosUUFBdUJBLFFBQVVGLEdBQU1PLEdBQUtELEVBQUVDLElBUHhFLENBU0dDLFFBQVEsV0FDWCxNLDJHQ1RBLGNBRUEsU0FFQSxXQUFPQyxlQUNMQyxFQUNBQyxHQUVBLE1BQU1DLEVBQU0sR0FBRyxFQUFBQyxrQkFBa0JGLElBQ2pDLE9BQU8sRUFBQUcsc0NBQ0NKLEVBQU9LLFFBQVEsQ0FBRUgsVyxzRUNYM0Isd0IsbUdDQUEsU0FDQSxTQUNBLFNBUUEsU0FRQSxTQUNBLFFBVU1JLEVBQVksdURBRWxCLDRCQU1BLE1BQWFDLFVBQW9CLEVBQUFDLGFBSS9CLFlBQXFCQyxHQUNuQkMsUUFEbUIsS0FBQUQsY0FHbkJFLEtBQUtDLGFBQWUsVUFBTUMsT0FBTyxDQUMvQkMsUUFBUyxFQUFBQyxpQkFDVEMsUUFBUyxDQUNQLGFBQWNWLEdBRWhCVyxhQUFjLFNBRWhCTixLQUFLTyxRQUFVLFVBQU1MLE9BQU8sQ0FDMUJDLFFBQVMsRUFBQUMsaUJBQ1RDLFFBQVMsQ0FDUCxhQUFjVixHQUVoQlcsYUFBYyxTQUVoQk4sS0FBS08sUUFBUUMsYUFBYWQsUUFBUWUsS0FDaENyQixNQUFPc0Is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QXpCL0ksRUFBT0QsUUFBVWdKLFFBQVEsYyxRQ0F6Qi9JLEVBQU9ELFFBQVVnSixRQUFRLFUsUUNBekIvSSxFQUFPRCxRQUFVZ0osUUFBUSxTQ0NyQkMsRUFBMkIsR0FHL0IsU0FBU0MsRUFBb0JDLEdBRTVCLElBQUlDLEVBQWVILEVBQXlCRSxHQUM1QyxRQUFxQjVGLElBQWpCNkYsRUFDSCxPQUFPQSxFQUFhcEosUUFHckIsSUFBSUMsRUFBU2dKLEVBQXlCRSxHQUFZLENBR2pEbkosUUFBUyxJQU9WLE9BSEFxSixFQUFvQkYsR0FBVWxKLEVBQVFBLEVBQU9ELFFBQVNrSixHQUcvQ2pKLEVBQU9ELFEsbUdDckJmLGVBQ0EsYUFBUyw2RUFBQWUsZUFDVCxVQUFlLEVBQUFBLGEiLCJmaWxlIjoiaW1ndXIubm9kZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSB7XG5cdFx0dmFyIGEgPSBmYWN0b3J5KCk7XG5cdFx0Zm9yKHZhciBpIGluIGEpICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgPyBleHBvcnRzIDogcm9vdClbaV0gPSBhW2ldO1xuXHR9XG59KShnbG9iYWwsIGZ1bmN0aW9uKCkge1xucmV0dXJuICIsImltcG9ydCB7IEltZ3VyQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50JztcbmltcG9ydCB7IEFMQlVNX0VORFBPSU5UIH0gZnJvbSAnLi4vY29tbW9uL2VuZHBvaW50cyc7XG5pbXBvcnQgeyBJbWd1ckFwaVJlc3BvbnNlLCBBbGJ1bURhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi91dGlscyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBbGJ1bShcbiAgY2xpZW50OiBJbWd1ckNsaWVudCxcbiAgYWxidW1IYXNoOiBzdHJpbmdcbik6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxBbGJ1bURhdGE+PiB7XG4gIGNvbnN0IHVybCA9IGAke0FMQlVNX0VORFBPSU5UfS8ke2FsYnVtSGFzaH1gO1xuICByZXR1cm4gZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShcbiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IHVybCB9KVxuICApIGFzIEltZ3VyQXBpUmVzcG9uc2U8QWxidW1EYXRhPjtcbn1cbiIsImV4cG9ydCAqIGZyb20gJy4vZ2V0QWxidW0nO1xuIiwiaW1wb3J0IHsgRXZlbnRFbWl0dGVyIH0gZnJvbSAnZXZlbnRzJztcbmltcG9ydCB7IGdldEF1dGhvcml6YXRpb25IZWFkZXIgfSBmcm9tICcuL2dldEF1dGhvcml6YXRpb25IZWFkZXInO1xuaW1wb3J0IHtcbiAgZGVsZXRlSW1hZ2UsXG4gIGZhdm9yaXRlSW1hZ2UsXG4gIGdldEltYWdlLFxuICB1cGxvYWQsXG4gIHVwZGF0ZUltYWdlLFxuICBVcGRhdGVJbWFnZVBheWxvYWQsXG59IGZyb20gJy4vaW1hZ2UnO1xuaW1wb3J0IHtcbiAgR2FsbGVyeU9wdGlvbnMsXG4gIGdldEdhbGxlcnksXG4gIGdldFN1YnJlZGRpdEdhbGxlcnksXG4gIFN1YnJlZGRpdEdhbGxlcnlPcHRpb25zLFxuICBzZWFyY2hHYWxsZXJ5LFxuICBTZWFyY2hHYWxsZXJ5T3B0aW9ucyxcbn0gZnJvbSAnLi9nYWxsZXJ5JztcbmltcG9ydCB7IGdldEFsYnVtIH0gZnJvbSAnLi9hbGJ1bSc7XG5pbXBvcnQgeyBJTUdVUl9BUElfUFJFRklYIH0gZnJvbSAnLi9jb21tb24vZW5kcG9pbnRzJztcbmltcG9ydCB7XG4gIEFsYnVtRGF0YSxcbiAgQ3JlZGVudGlhbHMsXG4gIEdhbGxlcnlEYXRhLFxuICBJbWFnZURhdGEsXG4gIEltZ3VyQXBpUmVzcG9uc2UsXG4gIFBheWxvYWQsXG59IGZyb20gJy4vY29tbW9uL3R5cGVzJztcblxuY29uc3QgVVNFUkFHRU5UID0gJ2ltZ3VyL25leHQgKGh0dHBzOi8vZ2l0aHViLmNvbS9rYWltYWxsZWEvbm9kZS1pbWd1ciknO1xuXG5pbXBvcnQgYXhpb3MsIHsgQXhpb3NJbnN0YW5jZSwgQXhpb3NSZXNwb25zZSwgQXhpb3NSZXF1ZXN0Q29uZmlnIH0gZnJvbSAnYXhpb3MnO1xuXG5leHBvcnQgdHlwZSB7XG4gIENyZWRlbnRpYWxzIGFzIEltZ3VyQ3JlZGVudGlhbHMsXG4gIEltZ3VyQXBpUmVzcG9uc2UsXG59O1xuZXhwb3J0IGNsYXNzIEltZ3VyQ2xpZW50IGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgcHJpdmF0ZSBwbGFpbkZldGNoZXI6IEF4aW9zSW5zdGFuY2U7XG4gIHByaXZhdGUgZmV0Y2hlcjogQXhpb3NJbnN0YW5jZTtcblxuICBjb25zdHJ1Y3RvcihyZWFkb25seSBjcmVkZW50aWFsczogQ3JlZGVudGlhbHMpIHtcbiAgICBzdXBlcigpO1xuXG4gICAgdGhpcy5wbGFpbkZldGNoZXIgPSBheGlvcy5jcmVhdGUoe1xuICAgICAgYmFzZVVSTDogSU1HVVJfQVBJX1BSRUZJWCxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ3VzZXItYWdlbnQnOiBVU0VSQUdFTlQsXG4gICAgICB9LFxuICAgICAgcmVzcG9uc2VUeXBlOiAnanNvbicsXG4gICAgfSk7XG4gICAgdGhpcy5mZXRjaGVyID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgIGJhc2VVUkw6IElNR1VSX0FQSV9QUkVGSVgsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICd1c2VyLWFnZW50JzogVVNFUkFHRU5ULFxuICAgICAgfSxcbiAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nLFxuICAgIH0pO1xuICAgIHRoaXMuZmV0Y2hlci5pbnRlcmNlcHRvcnMucmVxdWVzdC51c2UoXG4gICAgICBhc3luYyAoY29uZmlnOiBBeGlvc1JlcXVlc3RDb25maWcpID0+IHtcbiAgICAgICAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyA/IGNvbmZpZy5oZWFkZXJzIDoge307XG4gICAgICAgIGNvbmZpZy5oZWFkZXJzLmF1dGhvcml6YXRpb24gPSBhd2FpdCBnZXRBdXRob3JpemF0aW9uSGVhZGVyKHRoaXMpO1xuICAgICAgICByZXR1cm4gY29uZmlnO1xuICAgICAgfSxcbiAgICAgIChlOiBFcnJvcikgPT4gUHJvbWlzZS5yZWplY3QoZSlcbiAgICApO1xuICB9XG5cbiAgcGxhaW5SZXF1ZXN0KG9wdGlvbnM6IEF4aW9zUmVxdWVzdENvbmZpZyk6IFByb21pc2U8QXhpb3NSZXNwb25zZTx1bmtub3duPj4ge1xuICAgIHJldHVybiB0aGlzLnBsYWluRmV0Y2hlcihvcHRpb25zKTtcbiAgfVxuXG4gIHJlcXVlc3Qob3B0aW9uczogQXhpb3NSZXF1ZXN0Q29uZmlnID0ge30pOiBQcm9taXNlPEF4aW9zUmVzcG9uc2U8dW5rbm93bj4+IHtcbiAgICByZXR1cm4gdGhpcy5mZXRjaGVyKG9wdGlvbnMpO1xuICB9XG5cbiAgZGVsZXRlSW1hZ2UoaW1hZ2VIYXNoOiBzdHJpbmcpOiBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj4+IHtcbiAgICByZXR1cm4gZGVsZXRlSW1hZ2UodGhpcywgaW1hZ2VIYXNoKTtcbiAgfVxuXG4gIGZhdm9yaXRlSW1hZ2UoaW1hZ2VIYXNoOiBzdHJpbmcpOiBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8c3RyaW5nPj4ge1xuICAgIHJldHVybiBmYXZvcml0ZUltYWdlKHRoaXMsIGltYWdlSGFzaCk7XG4gIH1cblxuICBnZXRBbGJ1bShhbGJ1bUhhc2g6IHN0cmluZyk6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxBbGJ1bURhdGE+PiB7XG4gICAgcmV0dXJuIGdldEFsYnVtKHRoaXMsIGFsYnVtSGFzaCk7XG4gIH1cblxuICBnZXRHYWxsZXJ5KG9wdGlvbnM6IEdhbGxlcnlPcHRpb25zKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEdhbGxlcnlEYXRhPj4ge1xuICAgIHJldHVybiBnZXRHYWxsZXJ5KHRoaXMsIG9wdGlvbnMpO1xuICB9XG5cbiAgZ2V0U3VicmVkZGl0R2FsbGVyeShcbiAgICBvcHRpb25zOiBTdWJyZWRkaXRHYWxsZXJ5T3B0aW9uc1xuICApOiBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8R2FsbGVyeURhdGE+PiB7XG4gICAgcmV0dXJuIGdldFN1YnJlZGRpdEdhbGxlcnkodGhpcywgb3B0aW9ucyk7XG4gIH1cblxuICBzZWFyY2hHYWxsZXJ5KFxuICAgIG9wdGlvbnM6IFNlYXJjaEdhbGxlcnlPcHRpb25zXG4gICk6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxHYWxsZXJ5RGF0YT4+IHtcbiAgICByZXR1cm4gc2VhcmNoR2FsbGVyeSh0aGlzLCBvcHRpb25zKTtcbiAgfVxuXG4gIGdldEltYWdlKGltYWdlSGFzaDogc3RyaW5nKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT4+IHtcbiAgICByZXR1cm4gZ2V0SW1hZ2UodGhpcywgaW1hZ2VIYXNoKTtcbiAgfVxuXG4gIHVwZGF0ZUltYWdlKFxuICAgIHBheWxvYWQ6IFVwZGF0ZUltYWdlUGF5bG9hZCB8IFVwZGF0ZUltYWdlUGF5bG9hZFtdXG4gICk6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxib29sZWFuPiB8IEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj5bXT4ge1xuICAgIHJldHVybiB1cGRhdGVJbWFnZSh0aGlzLCBwYXlsb2FkKTtcbiAgfVxuXG4gIHVwbG9hZChcbiAgICBwYXlsb2FkOiBzdHJpbmcgfCBzdHJpbmdbXSB8IFBheWxvYWQgfCBQYXlsb2FkW11cbiAgKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT4gfCBJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT5bXT4ge1xuICAgIHJldHVybiB1cGxvYWQodGhpcywgcGF5bG9hZCk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBJTUdVUl9BUElfUFJFRklYID0gJ2h0dHBzOi8vYXBpLmltZ3VyLmNvbSc7XG5cbmV4cG9ydCBjb25zdCBBUElfVkVSU0lPTiA9ICczJztcblxuZXhwb3J0IGNvbnN0IEFVVEhPUklaRV9FTkRQT0lOVCA9ICdvYXV0aDIvYXV0aG9yaXplJztcblxuZXhwb3J0IGNvbnN0IEFMQlVNX0VORFBPSU5UID0gYCR7QVBJX1ZFUlNJT059L2FsYnVtYDtcblxuZXhwb3J0IGNvbnN0IElNQUdFX0VORFBPSU5UID0gYCR7QVBJX1ZFUlNJT059L2ltYWdlYDtcblxuZXhwb3J0IGNvbnN0IFVQTE9BRF9FTkRQT0lOVCA9IGAke0FQSV9WRVJTSU9OfS91cGxvYWRgO1xuXG5leHBvcnQgY29uc3QgR0FMTEVSWV9FTkRQT0lOVCA9IGAke0FQSV9WRVJTSU9OfS9nYWxsZXJ5YDtcblxuZXhwb3J0IGNvbnN0IFNVQlJFRERJVF9HQUxMRVJZX0VORFBPSU5UID0gYCR7QVBJX1ZFUlNJT059L2dhbGxlcnkvcmA7XG5cbmV4cG9ydCBjb25zdCBTRUFSQ0hfR0FMTEVSWV9FTkRQT0lOVCA9IGAke0FQSV9WRVJTSU9OfS9nYWxsZXJ5L3NlYXJjaGA7XG4iLCJpbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNjZXNzVG9rZW4ge1xuICBhY2Nlc3NUb2tlbjogc3RyaW5nO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIENsaWVudElkIHtcbiAgY2xpZW50SWQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dpbiBleHRlbmRzIENsaWVudElkIHtcbiAgdXNlcm5hbWU6IHN0cmluZztcbiAgcGFzc3dvcmQ6IHN0cmluZztcbn1cblxuZXhwb3J0IHR5cGUgQ3JlZGVudGlhbHMgPSBBY2Nlc3NUb2tlbiB8IENsaWVudElkIHwgTG9naW47XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0FjY2Vzc1Rva2VuKGFyZzogdW5rbm93bik6IGFyZyBpcyBBY2Nlc3NUb2tlbiB7XG4gIHJldHVybiAoYXJnIGFzIEFjY2Vzc1Rva2VuKS5hY2Nlc3NUb2tlbiAhPT0gdW5kZWZpbmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNDbGllbnRJZChhcmc6IHVua25vd24pOiBhcmcgaXMgQ2xpZW50SWQge1xuICByZXR1cm4gKGFyZyBhcyBDbGllbnRJZCkuY2xpZW50SWQgIT09IHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTG9naW4oYXJnOiB1bmtub3duKTogYXJnIGlzIExvZ2luIHtcbiAgcmV0dXJuIChcbiAgICAoYXJnIGFzIExvZ2luKS5jbGllbnRJZCAhPT0gdW5kZWZpbmVkICYmXG4gICAgKGFyZyBhcyBMb2dpbikudXNlcm5hbWUgIT09IHVuZGVmaW5lZCAmJlxuICAgIChhcmcgYXMgTG9naW4pLnBhc3N3b3JkICE9PSB1bmRlZmluZWRcbiAgKTtcbn1cblxuaW50ZXJmYWNlIENvbW1vbkRhdGEge1xuICBpZDogc3RyaW5nO1xuICB0aXRsZTogc3RyaW5nIHwgbnVsbDtcbiAgZGVzY3JpcHRpb246IHN0cmluZyB8IG51bGw7XG4gIGRhdGV0aW1lOiBudW1iZXI7XG4gIGxpbms6IHN0cmluZztcblxuICBhZF9jb25maWc/OiB7XG4gICAgc2FmZUZsYWdzOiBzdHJpbmdbXTtcbiAgICBoaWdoUmlza0ZsYWdzOiBzdHJpbmdbXTtcbiAgICB1bnNhZmVGbGFnczogc3RyaW5nW107XG4gICAgd2FsbFVuc2FmZUZsYWdzOiBzdHJpbmdbXTtcbiAgICBzaG93c0FkczogYm9vbGVhbjtcbiAgfTtcbiAgYWRfdHlwZTogbnVtYmVyO1xuICBhZF91cmw6IHN0cmluZztcblxuICBhY2NvdW50X3VybDogc3RyaW5nIHwgbnVsbDtcbiAgYWNjb3VudF9pZDogc3RyaW5nIHwgbnVsbDtcbiAgZmF2b3JpdGU6IGJvb2xlYW47XG4gIGlzX2FkOiBib29sZWFuO1xuICBpc19hbGJ1bTogYm9vbGVhbjtcbiAgaW5fZ2FsbGVyeTogYm9vbGVhbjtcbiAgaW5fbW9zdF92aXJhbDogYm9vbGVhbjtcbiAgbnNmdzogYm9vbGVhbiB8IG51bGw7XG4gIHNlY3Rpb246IHN0cmluZyB8IG51bGw7XG4gIHRhZ3M6IEFycmF5PHtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgZGlzcGxheV9uYW1lOiBzdHJpbmc7XG4gICAgZm9sbG93ZXJzOiBudW1iZXI7XG4gICAgdG90YWxfaXRlbXM6IG51bWJlcjtcbiAgICBmb2xsb3dpbmc6IGJvb2xlYW47XG4gICAgaXNfd2hpdGVsaXN0ZWQ6IGJvb2xlYW47XG4gICAgYmFja2dyb3VuZF9oYXNoOiBzdHJpbmc7XG4gICAgdGh1bWJuYWlsX2hhc2g6IHN0cmluZyB8IG51bGw7XG4gICAgYWNjZW50OiBzdHJpbmc7XG4gICAgYmFja2dyb3VuZF9pc19hbmltYXRlZDogYm9vbGVhbjtcbiAgICB0aHVtYm5haWxfaXNfYW5pbWF0ZWQ6IGJvb2xlYW47XG4gICAgaXNfcHJvbW90ZWQ6IGJvb2xlYW47XG4gICAgZGVzY3JpcHRpb246IHN0cmluZztcbiAgICBsb2dvX2hhc2g6IHN0cmluZyB8IG51bGw7XG4gICAgbG9nb19kZXN0aW5hdGlvbl91cmw6IHN0cmluZyB8IG51bGw7XG4gICAgZGVzY3JpcHRpb25fYW5ub3RhdGlvbnM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuICB9PjtcbiAgdG9waWM6IHN0cmluZyB8IG51bGw7XG4gIHRvcGljX2lkOiBzdHJpbmcgfCBudWxsO1xuICB2b3RlOiBudWxsO1xuXG4gIGNvbW1lbnRfY291bnQ6IG51bWJlciB8IG51bGw7XG4gIGZhdm9yaXRlX2NvdW50OiBudW1iZXIgfCBudWxsO1xuICB1cHM6IG51bWJlciB8IG51bGw7XG4gIGRvd25zOiBudW1iZXIgfCBudWxsO1xuICBzY29yZTogbnVtYmVyIHwgbnVsbDtcbiAgcG9pbnRzOiBudW1iZXIgfCBudWxsO1xuICB2aWV3czogbnVtYmVyO1xufVxuZXhwb3J0IGludGVyZmFjZSBJbWFnZURhdGEgZXh0ZW5kcyBDb21tb25EYXRhIHtcbiAgdHlwZTogc3RyaW5nO1xuICB3aWR0aDogbnVtYmVyO1xuICBoZWlnaHQ6IG51bWJlcjtcbiAgc2l6ZTogbnVtYmVyO1xuICBkZWxldGVoYXNoPzogc3RyaW5nO1xuICBiYW5kd2lkdGg6IG51bWJlcjtcbiAgYW5pbWF0ZWQ6IGJvb2xlYW47XG4gIGhhc19zb3VuZDogYm9vbGVhbjtcbiAgZWRpdGVkOiBzdHJpbmc7XG4gIG1wNF9zaXplPzogbnVtYmVyO1xuICBtcDQ/OiBzdHJpbmc7XG4gIGdpZnY/OiBzdHJpbmc7XG4gIGhscz86IHN0cmluZztcbiAgbG9vcGluZz86IGJvb2xlYW47XG4gIHByb2Nlc3Npbmc/OiB7XG4gICAgc3RhdHVzOiAncGVuZGluZycgfCAnY29tcGxldGVkJztcbiAgfTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBBbGJ1bURhdGEgZXh0ZW5kcyBDb21tb25EYXRhIHtcbiAgY292ZXI6IHN0cmluZyB8IG51bGw7XG4gIGNvdmVyX3dpZHRoOiBudW1iZXIgfCBudWxsO1xuICBjb3Zlcl9oZWlnaHQ6IG51bWJlciB8IG51bGw7XG4gIGxheW91dDogc3RyaW5nO1xuICBwcml2YWN5OiBzdHJpbmc7XG4gIGluY2x1ZGVfYWxidW1fYWRzOiBib29sZWFuO1xuICBpbWFnZXM6IEltYWdlRGF0YVtdO1xuICBpbWFnZXNfY291bnQ6IG51bWJlcjtcbn1cblxuZXhwb3J0IHR5cGUgR2FsbGVyeURhdGEgPSBBcnJheTxJbWFnZURhdGEgfCBBbGJ1bURhdGE+O1xuZXhwb3J0IGludGVyZmFjZSBQYXlsb2FkIHtcbiAgaW1hZ2U/OiBzdHJpbmc7XG4gIGJhc2U2ND86IHN0cmluZztcbiAgdHlwZT86ICdzdHJlYW0nIHwgJ3VybCcgfCAnYmFzZTY0JztcbiAgbmFtZT86IHN0cmluZztcbiAgdGl0bGU/OiBzdHJpbmc7XG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICBhbGJ1bT86IHN0cmluZztcbiAgc3RyZWFtPzogUmVhZGFibGU7XG4gIGRpc2FibGVfYXVkaW8/OiAnMScgfCAnMCc7XG59XG5leHBvcnQgaW50ZXJmYWNlIEltZ3VyQXBpUmVzcG9uc2U8XG4gIFQgPVxuICAgIHwgUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgICB8IFJlY29yZDxzdHJpbmcsIHVua25vd24+W11cbiAgICB8IHN0cmluZ1xuICAgIHwgYm9vbGVhblxuICAgIHwgSW1hZ2VEYXRhXG4gICAgfCBHYWxsZXJ5RGF0YVxuICAgIHwgQWxidW1EYXRhXG4+IHtcbiAgZGF0YTogVDtcbiAgc3RhdHVzOiBudW1iZXI7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG59XG4iLCJpbXBvcnQgeyBBeGlvc1Jlc3BvbnNlIH0gZnJvbSAnYXhpb3MnO1xuaW1wb3J0IEZvcm1EYXRhIGZyb20gJ2Zvcm0tZGF0YSc7XG5pbXBvcnQgeyBJbWd1ckFwaVJlc3BvbnNlLCBQYXlsb2FkIH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7XG5cbmV4cG9ydCBmdW5jdGlvbiBpc0Jhc2U2NChwYXlsb2FkOiBzdHJpbmcgfCBQYXlsb2FkKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgcGF5bG9hZCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICByZXR1cm4gdHlwZW9mIHBheWxvYWQuYmFzZTY0ICE9PSAndW5kZWZpbmVkJyAmJiBwYXlsb2FkLnR5cGUgPT09ICdiYXNlNjQnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNJbWFnZVVybChwYXlsb2FkOiBzdHJpbmcgfCBQYXlsb2FkKTogYm9vbGVhbiB7XG4gIGlmICh0eXBlb2YgcGF5bG9hZCA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiB0eXBlb2YgcGF5bG9hZC5pbWFnZSAhPT0gJ3VuZGVmaW5lZCcgJiYgcGF5bG9hZC50eXBlID09PSAndXJsJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzU3RyZWFtKHBheWxvYWQ6IHN0cmluZyB8IFBheWxvYWQpOiBib29sZWFuIHtcbiAgaWYgKHR5cGVvZiBwYXlsb2FkID09PSAnc3RyaW5nJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHJldHVybiB0eXBlb2YgcGF5bG9hZC5zdHJlYW0gIT09ICd1bmRlZmluZWQnO1xufVxuXG4vLyBUT0RPOiBSZWZhY3RvciB0aGlzIHRvIGJlIGEgdW5pcXVlIG5hbWUgb2Ygc29tZSBraW5kIChhIGhhc2g/KVxuZXhwb3J0IGZ1bmN0aW9uIGdldFNvdXJjZShwYXlsb2FkOiBzdHJpbmcgfCBQYXlsb2FkKTogc3RyaW5nIHwgUmVhZGFibGUge1xuICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIHBheWxvYWQ7XG4gIH1cblxuICBpZiAoaXNCYXNlNjQocGF5bG9hZCkpIHtcbiAgICByZXR1cm4gJ3BheWxvYWQuYmFzZTY0JyBhcyBzdHJpbmc7XG4gIH0gZWxzZSBpZiAoaXNTdHJlYW0ocGF5bG9hZCkpIHtcbiAgICByZXR1cm4gJ3BheWxvYWQuc3RyZWFtJyBhcyBzdHJpbmc7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHBheWxvYWQuaW1hZ2UgYXMgc3RyaW5nO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVGb3JtKHBheWxvYWQ6IHN0cmluZyB8IFBheWxvYWQpOiBGb3JtRGF0YSB7XG4gIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTtcblxuICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnKSB7XG4gICAgZm9ybS5hcHBlbmQoJ2ltYWdlJywgcGF5bG9hZCk7XG4gICAgcmV0dXJuIGZvcm07XG4gIH1cblxuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwYXlsb2FkKSkge1xuICAgIGNvbnN0IHN1cHBvcnRlZFVwbG9hZE9iamVjdFR5cGVzID0gWydiYXNlNjQnLCAnc3RyZWFtJ107XG4gICAgaWYgKHN1cHBvcnRlZFVwbG9hZE9iamVjdFR5cGVzLmluZGV4T2Yoa2V5KSAhPT0gLTEpIHtcbiAgICAgIGlmIChzdXBwb3J0ZWRVcGxvYWRPYmplY3RUeXBlcy5pbmRleE9mKHBheWxvYWQudHlwZSBhcyBzdHJpbmcpICE9PSAtMSkge1xuICAgICAgICBmb3JtLmFwcGVuZChrZXksIHBheWxvYWQpO1xuICAgICAgfSBlbHNlIGlmIChwYXlsb2FkLnR5cGUgPT09ICd1cmwnKSB7XG4gICAgICAgIGZvcm0uYXBwZW5kKGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBmb3JtLmFwcGVuZChrZXksIHZhbHVlKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIGZvcm07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlKFxuICByZXNwb25zZTogQXhpb3NSZXNwb25zZVxuKTogSW1ndXJBcGlSZXNwb25zZSB7XG4gIGlmIChcbiAgICB0eXBlb2YgcmVzcG9uc2UuZGF0YT8uc3RhdHVzICE9PSAndW5kZWZpbmVkJyAmJlxuICAgIHR5cGVvZiByZXNwb25zZS5kYXRhPy5zdWNjZXNzICE9PSAndW5kZWZpbmVkJ1xuICApIHtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgZGF0YTogcmVzcG9uc2UuZGF0YSxcbiAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAvLyBUT0RPOiBkZXRlcm1pbmUgdGhlIHN1Y2Nlc3Mgb2YgdGhlIGNhbGw/XG4gICAgc3VjY2VzczogdHJ1ZSxcbiAgfTtcbn1cbiIsImltcG9ydCB7IEltZ3VyQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50JztcbmltcG9ydCB7IEdBTExFUllfRU5EUE9JTlQsIElNR1VSX0FQSV9QUkVGSVggfSBmcm9tICcuLi9jb21tb24vZW5kcG9pbnRzJztcbmltcG9ydCB7IEltZ3VyQXBpUmVzcG9uc2UsIEdhbGxlcnlEYXRhIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzJztcbmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7XG5pbXBvcnQgeyBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlIH0gZnJvbSAnLi4vY29tbW9uL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgQ29tbW9uU2VjdGlvblByb3BzID0ge1xuICBzb3J0PzogJ3ZpcmFsJyB8ICd0b3AnIHwgJ3RpbWUnO1xuICBwYWdlPzogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgSG90U2VjdGlvbiA9IENvbW1vblNlY3Rpb25Qcm9wcyAmIHtcbiAgc2VjdGlvbjogJ2hvdCc7XG59O1xuXG5leHBvcnQgdHlwZSBUb3BTZWN0aW9uID0gQ29tbW9uU2VjdGlvblByb3BzICYge1xuICBzZWN0aW9uOiAndG9wJztcbiAgd2luZG93PzogJ2RheScgfCAnd2VlaycgfCAnbW9udGgnIHwgJ3llYXInIHwgJ2FsbCc7XG59O1xuXG5leHBvcnQgdHlwZSBVc2VyU2VjdGlvbiA9IE9taXQ8Q29tbW9uU2VjdGlvblByb3BzLCAnc29ydCc+ICYge1xuICBzZWN0aW9uOiAndXNlcic7XG4gIHNvcnQ/OiAndmlyYWwnIHwgJ3RvcCcgfCAndGltZScgfCAncmlzaW5nJztcbn07XG5cbmV4cG9ydCB0eXBlIFNlY3Rpb25PcHRpb25zID0gSG90U2VjdGlvbiB8IFRvcFNlY3Rpb24gfCBVc2VyU2VjdGlvbjtcblxuZXhwb3J0IHR5cGUgUHJlc2VudGF0aW9uT3B0aW9ucyA9IHtcbiAgc2hvd1ZpcmFsPzogYm9vbGVhbjtcbiAgbWF0dXJlPzogYm9vbGVhbjtcbiAgYWxidW1fcHJldmlld3M/OiBib29sZWFuO1xufTtcblxuZXhwb3J0IHR5cGUgR2FsbGVyeU9wdGlvbnMgPSBTZWN0aW9uT3B0aW9ucyAmIFByZXNlbnRhdGlvbk9wdGlvbnM7XG5cbmNvbnN0IGRlZmF1bHRPcHRpb25zOiBHYWxsZXJ5T3B0aW9ucyA9IHtcbiAgc2VjdGlvbjogJ2hvdCcsXG4gIHNvcnQ6ICd2aXJhbCcsXG59O1xuXG5leHBvcnQgZnVuY3Rpb24gY29uc3RydWN0R2FsbGVyeVVybChvcHRpb25zOiBHYWxsZXJ5T3B0aW9ucyk6IFVSTCB7XG4gIGNvbnN0IG1lcmdlZE9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHt9LCBkZWZhdWx0T3B0aW9ucywgb3B0aW9ucyk7XG5cbiAgbGV0IHVyaSA9IGAke21lcmdlZE9wdGlvbnMuc2VjdGlvbn1gO1xuXG4gIGlmIChtZXJnZWRPcHRpb25zLnNvcnQpIHtcbiAgICB1cmkgKz0gYC8ke21lcmdlZE9wdGlvbnMuc29ydH1gO1xuICB9XG5cbiAgaWYgKG1lcmdlZE9wdGlvbnMuc2VjdGlvbiA9PT0gJ3RvcCcgJiYgbWVyZ2VkT3B0aW9ucy53aW5kb3cpIHtcbiAgICB1cmkgKz0gYC8ke21lcmdlZE9wdGlvbnMud2luZG93fWA7XG4gIH1cblxuICBpZiAobWVyZ2VkT3B0aW9ucy5wYWdlKSB7XG4gICAgdXJpICs9IGAvJHttZXJnZWRPcHRpb25zLnBhZ2V9YDtcbiAgfVxuXG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7SU1HVVJfQVBJX1BSRUZJWH0vJHtHQUxMRVJZX0VORFBPSU5UfS8ke3VyaX1gKTtcblxuICBpZiAobWVyZ2VkT3B0aW9ucy5zaG93VmlyYWwgIT09IHVuZGVmaW5lZCkge1xuICAgIHVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKCdzaG93VmlyYWwnLCBtZXJnZWRPcHRpb25zLnNob3dWaXJhbC50b1N0cmluZygpKTtcbiAgfVxuXG4gIGlmIChtZXJnZWRPcHRpb25zLm1hdHVyZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5hcHBlbmQoJ21hdHVyZScsIG1lcmdlZE9wdGlvbnMubWF0dXJlLnRvU3RyaW5nKCkpO1xuICB9XG5cbiAgaWYgKG1lcmdlZE9wdGlvbnMuYWxidW1fcHJldmlld3MgIT09IHVuZGVmaW5lZCkge1xuICAgIHVybC5zZWFyY2hQYXJhbXMuYXBwZW5kKFxuICAgICAgJ2FsYnVtX3ByZXZpZXdzJyxcbiAgICAgIG1lcmdlZE9wdGlvbnMuYWxidW1fcHJldmlld3MudG9TdHJpbmcoKVxuICAgICk7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0R2FsbGVyeShcbiAgY2xpZW50OiBJbWd1ckNsaWVudCxcbiAgb3B0aW9uczogR2FsbGVyeU9wdGlvbnMgPSBkZWZhdWx0T3B0aW9uc1xuKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEdhbGxlcnlEYXRhPj4ge1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSBjb25zdHJ1Y3RHYWxsZXJ5VXJsKG9wdGlvbnMpO1xuICAvLyBzaW5jZSB3ZSdyZSB1c2luZyBwcmVmaXhVcmwgd2l0aCBnb3QsIHdlIGhhdmUgdG8gcmVtb3ZlIHRoZSBzdGFydGluZyBzbGFzaCBvciBpdCdsbCB0aHJvd1xuICBjb25zdCBmaW5hbFBhdGhuYW1lID0gcGF0aG5hbWUuc2xpY2UoMSk7XG5cbiAgcmV0dXJuIGdldEltZ3VyQXBpUmVzcG9uc2VGcm9tUmVzcG9uc2UoXG4gICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoeyB1cmw6IGZpbmFsUGF0aG5hbWUgfSlcbiAgKSBhcyBJbWd1ckFwaVJlc3BvbnNlPEdhbGxlcnlEYXRhPjtcbn1cbiIsImltcG9ydCB7IEltZ3VyQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50JztcbmltcG9ydCB7XG4gIFNVQlJFRERJVF9HQUxMRVJZX0VORFBPSU5ULFxuICBJTUdVUl9BUElfUFJFRklYLFxufSBmcm9tICcuLi9jb21tb24vZW5kcG9pbnRzJztcbmltcG9ydCB7IEltZ3VyQXBpUmVzcG9uc2UsIEdhbGxlcnlEYXRhIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzJztcbmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7XG5pbXBvcnQgeyBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlIH0gZnJvbSAnLi4vY29tbW9uL3V0aWxzJztcblxuZXhwb3J0IHR5cGUgVGltZU9wdGlvbnMgPSB7XG4gIHN1YnJlZGRpdDogc3RyaW5nO1xuICBzb3J0PzogJ3RpbWUnO1xuICBwYWdlPzogbnVtYmVyO1xufTtcblxuZXhwb3J0IHR5cGUgVG9wT3B0aW9ucyA9IE9taXQ8VGltZU9wdGlvbnMsICdzb3J0Jz4gJiB7XG4gIHNvcnQ/OiAndG9wJztcbiAgd2luZG93PzogJ2RheScgfCAnd2VlaycgfCAnbW9udGgnIHwgJ3llYXInIHwgJ2FsbCc7XG59O1xuXG5leHBvcnQgdHlwZSBTdWJyZWRkaXRHYWxsZXJ5T3B0aW9ucyA9IFRpbWVPcHRpb25zIHwgVG9wT3B0aW9ucztcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnN0cnVjdFN1YnJlZGRpdEdhbGxlcnlVcmwoXG4gIG9wdGlvbnM6IFN1YnJlZGRpdEdhbGxlcnlPcHRpb25zXG4pOiBVUkwge1xuICBsZXQgdXJpID0gYCR7b3B0aW9ucy5zdWJyZWRkaXR9YDtcblxuICBpZiAob3B0aW9ucy5zb3J0KSB7XG4gICAgdXJpICs9IGAvJHtvcHRpb25zLnNvcnR9YDtcbiAgfVxuXG4gIGlmIChvcHRpb25zLnNvcnQgPT09ICd0b3AnICYmIG9wdGlvbnMud2luZG93KSB7XG4gICAgdXJpICs9IGAvJHtvcHRpb25zLndpbmRvd31gO1xuICB9XG5cbiAgaWYgKG9wdGlvbnMucGFnZSkge1xuICAgIHVyaSArPSBgLyR7b3B0aW9ucy5wYWdlfWA7XG4gIH1cblxuICBjb25zdCB1cmwgPSBuZXcgVVJMKFxuICAgIGAke0lNR1VSX0FQSV9QUkVGSVh9LyR7U1VCUkVERElUX0dBTExFUllfRU5EUE9JTlR9LyR7dXJpfWBcbiAgKTtcblxuICByZXR1cm4gdXJsO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3VicmVkZGl0R2FsbGVyeShcbiAgY2xpZW50OiBJbWd1ckNsaWVudCxcbiAgb3B0aW9uczogU3VicmVkZGl0R2FsbGVyeU9wdGlvbnNcbik6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxHYWxsZXJ5RGF0YT4+IHtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gY29uc3RydWN0U3VicmVkZGl0R2FsbGVyeVVybChvcHRpb25zKTtcbiAgLy8gc2luY2Ugd2UncmUgdXNpbmcgcHJlZml4VXJsIHdpdGggZ290LCB3ZSBoYXZlIHRvIHJlbW92ZSB0aGUgc3RhcnRpbmcgc2xhc2ggb3IgaXQnbGwgdGhyb3dcbiAgY29uc3QgZmluYWxQYXRobmFtZSA9IHBhdGhuYW1lLnNsaWNlKDEpO1xuXG4gIHJldHVybiBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlKFxuICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHsgdXJsOiBmaW5hbFBhdGhuYW1lIH0pXG4gICkgYXMgSW1ndXJBcGlSZXNwb25zZTxHYWxsZXJ5RGF0YT47XG59XG4iLCJleHBvcnQgKiBmcm9tICcuL2dldEdhbGxlcnknO1xuZXhwb3J0ICogZnJvbSAnLi9nZXRTdWJyZWRkaXRHYWxsZXJ5JztcbmV4cG9ydCAqIGZyb20gJy4vc2VhcmNoR2FsbGVyeSc7XG4iLCJpbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQgeyBTRUFSQ0hfR0FMTEVSWV9FTkRQT0lOVCwgSU1HVVJfQVBJX1BSRUZJWCB9IGZyb20gJy4uL2NvbW1vbi9lbmRwb2ludHMnO1xuaW1wb3J0IHsgSW1ndXJBcGlSZXNwb25zZSwgR2FsbGVyeURhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi91dGlscyc7XG5pbXBvcnQgeyBVUkwgfSBmcm9tICd1cmwnO1xuXG5leHBvcnQgdHlwZSBTZWFyY2hPcHRpb25zID0ge1xuICBxPzogc3RyaW5nO1xuICBxdWVyeT86IHN0cmluZztcbiAgc29ydD86ICd0aW1lJyB8ICd2aXJhbCc7XG4gIHBhZ2U/OiBudW1iZXI7XG59O1xuXG5leHBvcnQgdHlwZSBUb3BTZWFyY2hPcHRpb25zID0gT21pdDxTZWFyY2hPcHRpb25zLCAnc29ydCc+ICYge1xuICBzb3J0PzogJ3RvcCc7XG4gIHdpbmRvdz86ICdkYXknIHwgJ3dlZWsnIHwgJ21vbnRoJyB8ICd5ZWFyJyB8ICdhbGwnO1xufTtcblxuZXhwb3J0IHR5cGUgQWR2YW5jZWRTZWFyY2hRdWVyeVBhcmFtZXRlcnMgPSB7XG4gIHFfYWxsPzogc3RyaW5nO1xuICBxX2FueT86IHN0cmluZztcbiAgcV9leGFjdGx5Pzogc3RyaW5nO1xuICBxX25vdD86IHN0cmluZztcbiAgcV90eXBlPzogJ2pwZycgfCAncG5nJyB8ICdnaWYnIHwgJ2FuaWdpZicgfCAnYWxidW0nO1xuICBxX3NpemVfcHg/OiAnc21hbGwnIHwgJ21lZCcgfCAnYmlnJyB8ICdscmcnIHwgJ2h1Z2UnO1xufTtcblxuY29uc3QgYWR2YW5jZWRQYXJhbWV0ZXJzOiBBcnJheTxrZXlvZiBBZHZhbmNlZFNlYXJjaFF1ZXJ5UGFyYW1ldGVycz4gPSBbXG4gICdxX2FsbCcsXG4gICdxX2FueScsXG4gICdxX2V4YWN0bHknLFxuICAncV9ub3QnLFxuICAncV90eXBlJyxcbiAgJ3Ffc2l6ZV9weCcsXG5dO1xuXG5leHBvcnQgdHlwZSBTZWFyY2hHYWxsZXJ5T3B0aW9ucyA9IChTZWFyY2hPcHRpb25zIHwgVG9wU2VhcmNoT3B0aW9ucykgJlxuICBBZHZhbmNlZFNlYXJjaFF1ZXJ5UGFyYW1ldGVycztcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnN0cnVjdFNlYXJjaEdhbGxlcnlVcmwob3B0aW9uczogU2VhcmNoR2FsbGVyeU9wdGlvbnMpOiBVUkwge1xuICBsZXQgdXJpID0gJyc7XG5cbiAgaWYgKG9wdGlvbnMuc29ydCkge1xuICAgIHVyaSArPSBgLyR7b3B0aW9ucy5zb3J0fWA7XG4gIH1cblxuICBpZiAob3B0aW9ucy5zb3J0ID09PSAndG9wJyAmJiBvcHRpb25zLndpbmRvdykge1xuICAgIHVyaSArPSBgLyR7b3B0aW9ucy53aW5kb3d9YDtcbiAgfVxuXG4gIGlmIChvcHRpb25zLnBhZ2UpIHtcbiAgICB1cmkgKz0gYC8ke29wdGlvbnMucGFnZX1gO1xuICB9XG5cbiAgY29uc3QgdXJsID0gbmV3IFVSTChgJHtJTUdVUl9BUElfUFJFRklYfS8ke1NFQVJDSF9HQUxMRVJZX0VORFBPSU5UfSR7dXJpfWApO1xuXG4gIGFkdmFuY2VkUGFyYW1ldGVycy5mb3JFYWNoKChwYXJhbSkgPT4ge1xuICAgIGlmIChvcHRpb25zW3BhcmFtXT8ubGVuZ3RoKSB7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLmFwcGVuZChwYXJhbSwgb3B0aW9uc1twYXJhbV0gYXMgc3RyaW5nKTtcbiAgICB9XG4gIH0pO1xuXG4gIGlmICghdXJsLnNlYXJjaCkge1xuICAgIGNvbnN0IHF1ZXJ5ID0gb3B0aW9ucy5xIHx8IG9wdGlvbnMucXVlcnk7XG4gICAgaWYgKCFxdWVyeSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyBxdWVyeSB3YXMgcHJvdmlkZWQnKTtcbiAgICB9XG5cbiAgICB1cmwuc2VhcmNoUGFyYW1zLmFwcGVuZCgncScsIHF1ZXJ5KTtcbiAgfVxuXG4gIHJldHVybiB1cmw7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZWFyY2hHYWxsZXJ5KFxuICBjbGllbnQ6IEltZ3VyQ2xpZW50LFxuICBvcHRpb25zOiBTZWFyY2hHYWxsZXJ5T3B0aW9uc1xuKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEdhbGxlcnlEYXRhPj4ge1xuICBjb25zdCB7IHBhdGhuYW1lIH0gPSBjb25zdHJ1Y3RTZWFyY2hHYWxsZXJ5VXJsKG9wdGlvbnMpO1xuICAvLyBzaW5jZSB3ZSdyZSB1c2luZyBwcmVmaXhVcmwgd2l0aCBnb3QsIHdlIGhhdmUgdG8gcmVtb3ZlIHRoZSBzdGFydGluZyBzbGFzaCBvciBpdCdsbCB0aHJvd1xuICBjb25zdCBmaW5hbFBhdGhuYW1lID0gcGF0aG5hbWUuc2xpY2UoMSk7XG5cbiAgcmV0dXJuIGdldEltZ3VyQXBpUmVzcG9uc2VGcm9tUmVzcG9uc2UoXG4gICAgYXdhaXQgY2xpZW50LnJlcXVlc3QoeyB1cmw6IGZpbmFsUGF0aG5hbWUgfSlcbiAgKSBhcyBJbWd1ckFwaVJlc3BvbnNlPEdhbGxlcnlEYXRhPjtcbn1cbiIsImltcG9ydCB7XG4gIEFjY2Vzc1Rva2VuLFxuICBpc0FjY2Vzc1Rva2VuLFxuICBpc0NsaWVudElkLFxuICBpc0xvZ2luLFxufSBmcm9tICcuL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4vY2xpZW50JztcbmltcG9ydCB7IElNR1VSX0FQSV9QUkVGSVgsIEFVVEhPUklaRV9FTkRQT0lOVCB9IGZyb20gJy4vY29tbW9uL2VuZHBvaW50cyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdXRob3JpemF0aW9uSGVhZGVyKFxuICBjbGllbnQ6IEltZ3VyQ2xpZW50XG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBpZiAoaXNBY2Nlc3NUb2tlbihjbGllbnQuY3JlZGVudGlhbHMpKSB7XG4gICAgcmV0dXJuIGBCZWFyZXIgJHtjbGllbnQuY3JlZGVudGlhbHMuYWNjZXNzVG9rZW59YDtcbiAgfVxuXG4gIGlmIChpc0NsaWVudElkKGNsaWVudC5jcmVkZW50aWFscykgJiYgIWlzTG9naW4oY2xpZW50LmNyZWRlbnRpYWxzKSkge1xuICAgIHJldHVybiBgQ2xpZW50LUlEICR7Y2xpZW50LmNyZWRlbnRpYWxzLmNsaWVudElkfWA7XG4gIH1cblxuICBjb25zdCB7IGNsaWVudElkLCB1c2VybmFtZSwgcGFzc3dvcmQgfSA9IGNsaWVudC5jcmVkZW50aWFscztcblxuICBjb25zdCBvcHRpb25zOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IHtcbiAgICB1cmw6IEFVVEhPUklaRV9FTkRQT0lOVCxcbiAgICBiYXNlVVJMOiBJTUdVUl9BUElfUFJFRklYLFxuICAgIHBhcmFtczoge1xuICAgICAgY2xpZW50X2lkOiBjbGllbnRJZCxcbiAgICAgIHJlc3BvbnNlX3R5cGU6ICd0b2tlbicsXG4gICAgfSxcbiAgfTtcblxuICBsZXQgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQucGxhaW5SZXF1ZXN0KG9wdGlvbnMpO1xuXG4gIGNvbnN0IGNvb2tpZXMgPSBBcnJheS5pc0FycmF5KHJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXSlcbiAgICA/IHJlc3BvbnNlLmhlYWRlcnNbJ3NldC1jb29raWUnXVswXVxuICAgIDogcmVzcG9uc2UuaGVhZGVyc1snc2V0LWNvb2tpZSddO1xuXG4gIGlmICghY29va2llcykge1xuICAgIHRocm93IG5ldyBFcnJvcignTm8gY29va2llcyB3ZXJlIHNldCBkdXJpbmcgYXV0aG9yaXphdGlvbicpO1xuICB9XG5cbiAgY29uc3QgbWF0Y2hlcyA9IGNvb2tpZXMubWF0Y2goJyhefDspW3NdKmF1dGhvcml6ZV90b2tlbj0oW147XSopJyk7XG5cbiAgaWYgKCFtYXRjaGVzIHx8IG1hdGNoZXMubGVuZ3RoIDwgMykge1xuICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGZpbmQgYXV0aG9yaXplX3Rva2VuIGNvb2tpZScpO1xuICB9XG5cbiAgY29uc3QgYXV0aG9yaXplVG9rZW4gPSBtYXRjaGVzWzJdO1xuXG4gIG9wdGlvbnMubWV0aG9kID0gJ1BPU1QnO1xuICBvcHRpb25zLmRhdGEgPSB7XG4gICAgdXNlcm5hbWUsXG4gICAgcGFzc3dvcmQsXG4gICAgYWxsb3c6IGF1dGhvcml6ZVRva2VuLFxuICB9O1xuXG4gIG9wdGlvbnMuZm9sbG93UmVkaXJlY3QgPSBmYWxzZTtcbiAgb3B0aW9ucy5oZWFkZXJzID0ge1xuICAgIGNvb2tpZTogYGF1dGhvcml6ZV90b2tlbj0ke2F1dGhvcml6ZVRva2VufWAsXG4gIH07XG5cbiAgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQucGxhaW5SZXF1ZXN0KG9wdGlvbnMpO1xuICBjb25zdCBsb2NhdGlvbiA9IHJlc3BvbnNlLmhlYWRlcnMubG9jYXRpb247XG4gIGlmICghbG9jYXRpb24pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byBwYXJzZSBsb2NhdGlvbicpO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBKU09OLnBhcnNlKFxuICAgICd7XCInICtcbiAgICAgIGRlY29kZVVSSShsb2NhdGlvbi5zbGljZShsb2NhdGlvbi5pbmRleE9mKCcjJykgKyAxKSlcbiAgICAgICAgLnJlcGxhY2UoL1wiL2csICdcXFxcXCInKVxuICAgICAgICAucmVwbGFjZSgvJi9nLCAnXCIsXCInKVxuICAgICAgICAucmVwbGFjZSgvPS9nLCAnXCI6XCInKSArXG4gICAgICAnXCJ9J1xuICApO1xuXG4gIGNvbnN0IGFjY2Vzc1Rva2VuID0gdG9rZW4uYWNjZXNzX3Rva2VuO1xuICAoKGNsaWVudC5jcmVkZW50aWFscyBhcyB1bmtub3duKSBhcyBBY2Nlc3NUb2tlbikuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcblxuICByZXR1cm4gYEJlYXJlciAke2FjY2Vzc1Rva2VufWA7XG59XG4iLCJpbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQgeyBJTUFHRV9FTkRQT0lOVCB9IGZyb20gJy4uL2NvbW1vbi9lbmRwb2ludHMnO1xuaW1wb3J0IHsgSW1ndXJBcGlSZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlIH0gZnJvbSAnLi4vY29tbW9uL3V0aWxzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUltYWdlKFxuICBjbGllbnQ6IEltZ3VyQ2xpZW50LFxuICBpbWFnZUhhc2g6IHN0cmluZ1xuKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPGJvb2xlYW4+PiB7XG4gIGNvbnN0IHVybCA9IGAke0lNQUdFX0VORFBPSU5UfS8ke2ltYWdlSGFzaH1gO1xuICByZXR1cm4gZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShcbiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IHVybCwgbWV0aG9kOiAnREVMRVRFJyB9KVxuICApIGFzIEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj47XG59XG4iLCJpbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQgeyBJTUFHRV9FTkRQT0lOVCB9IGZyb20gJy4uL2NvbW1vbi9lbmRwb2ludHMnO1xuaW1wb3J0IHsgSW1ndXJBcGlSZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi90eXBlcyc7XG5pbXBvcnQgeyBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlIH0gZnJvbSAnLi4vY29tbW9uL3V0aWxzJztcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZhdm9yaXRlSW1hZ2UoXG4gIGNsaWVudDogSW1ndXJDbGllbnQsXG4gIGltYWdlSGFzaDogc3RyaW5nXG4pOiBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8J2Zhdm9yaXRlZCc+PiB7XG4gIGNvbnN0IHVybCA9IGAke0lNQUdFX0VORFBPSU5UfS8ke2ltYWdlSGFzaH0vZmF2b3JpdGVgO1xuICByZXR1cm4gZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShcbiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IHVybCwgbWV0aG9kOiAnUE9TVCcgfSlcbiAgKSBhcyBJbWd1ckFwaVJlc3BvbnNlPCdmYXZvcml0ZWQnPjtcbn1cbiIsImltcG9ydCB7IEltZ3VyQ2xpZW50IH0gZnJvbSAnLi4vY2xpZW50JztcbmltcG9ydCB7IElNQUdFX0VORFBPSU5UIH0gZnJvbSAnLi4vY29tbW9uL2VuZHBvaW50cyc7XG5pbXBvcnQgeyBJbWd1ckFwaVJlc3BvbnNlLCBJbWFnZURhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi91dGlscyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRJbWFnZShcbiAgY2xpZW50OiBJbWd1ckNsaWVudCxcbiAgaW1hZ2VIYXNoOiBzdHJpbmdcbik6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxJbWFnZURhdGE+PiB7XG4gIGNvbnN0IHVybCA9IGAke0lNQUdFX0VORFBPSU5UfS8ke2ltYWdlSGFzaH1gO1xuICByZXR1cm4gZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShcbiAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7IHVybCB9KVxuICApIGFzIEltZ3VyQXBpUmVzcG9uc2U8SW1hZ2VEYXRhPjtcbn1cbiIsImV4cG9ydCAqIGZyb20gJy4vZGVsZXRlSW1hZ2UnO1xuZXhwb3J0ICogZnJvbSAnLi9mYXZvcml0ZUltYWdlJztcbmV4cG9ydCAqIGZyb20gJy4vZ2V0SW1hZ2UnO1xuZXhwb3J0ICogZnJvbSAnLi91cGRhdGVJbWFnZSc7XG5leHBvcnQgKiBmcm9tICcuL3VwbG9hZCc7XG4iLCJpbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQgeyBJTUFHRV9FTkRQT0lOVCB9IGZyb20gJy4uL2NvbW1vbi9lbmRwb2ludHMnO1xuaW1wb3J0IHsgY3JlYXRlRm9ybSwgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZSB9IGZyb20gJy4uL2NvbW1vbi91dGlscyc7XG5pbXBvcnQgeyBQYXlsb2FkLCBJbWd1ckFwaVJlc3BvbnNlIH0gZnJvbSAnLi4vY29tbW9uL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBVcGRhdGVJbWFnZVBheWxvYWRcbiAgZXh0ZW5kcyBQaWNrPFBheWxvYWQsICd0aXRsZScgfCAnZGVzY3JpcHRpb24nPiB7XG4gIGltYWdlSGFzaDogc3RyaW5nO1xufVxuXG5mdW5jdGlvbiBpc1ZhbGlkVXBkYXRlUGF5bG9hZChwOiBVcGRhdGVJbWFnZVBheWxvYWQpIHtcbiAgcmV0dXJuIHR5cGVvZiBwLnRpdGxlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgcC5kZXNjcmlwdGlvbiA9PT0gJ3N0cmluZyc7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVJbWFnZShcbiAgY2xpZW50OiBJbWd1ckNsaWVudCxcbiAgcGF5bG9hZDogVXBkYXRlSW1hZ2VQYXlsb2FkIHwgVXBkYXRlSW1hZ2VQYXlsb2FkW11cbik6IFByb21pc2U8SW1ndXJBcGlSZXNwb25zZTxib29sZWFuPiB8IEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj5bXT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShwYXlsb2FkKSkge1xuICAgIGNvbnN0IHByb21pc2VzID0gcGF5bG9hZC5tYXAoKHA6IFVwZGF0ZUltYWdlUGF5bG9hZCkgPT4ge1xuICAgICAgaWYgKCFpc1ZhbGlkVXBkYXRlUGF5bG9hZChwKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VwZGF0ZSByZXF1aXJlcyBhIHRpdGxlIGFuZC9vciBkZXNjcmlwdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1cmwgPSBgJHtJTUFHRV9FTkRQT0lOVH0vJHtwLmltYWdlSGFzaH1gO1xuICAgICAgY29uc3QgZm9ybSA9IGNyZWF0ZUZvcm0ocCk7XG4gICAgICAvKiBlc2xpbnQgbm8tYXN5bmMtcHJvbWlzZS1leGVjdXRvcjogMCAqL1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKFxuICAgICAgICAgIGdldEltZ3VyQXBpUmVzcG9uc2VGcm9tUmVzcG9uc2UoXG4gICAgICAgICAgICBhd2FpdCBjbGllbnQucmVxdWVzdCh7XG4gICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICAgICAgICAgIGRhdGE6IGZvcm0sXG4gICAgICAgICAgICAgIC8vIHJlc29sdmVCb2R5T25seTogdHJ1ZSxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgKSBhcyBJbWd1ckFwaVJlc3BvbnNlPGJvb2xlYW4+XG4gICAgICAgICk7XG4gICAgICB9KSBhcyBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj4+O1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgfVxuXG4gIGlmICghaXNWYWxpZFVwZGF0ZVBheWxvYWQocGF5bG9hZCkpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1VwZGF0ZSByZXF1aXJlcyBhIHRpdGxlIGFuZC9vciBkZXNjcmlwdGlvbicpO1xuICB9XG5cbiAgY29uc3QgdXJsID0gYCR7SU1BR0VfRU5EUE9JTlR9LyR7cGF5bG9hZC5pbWFnZUhhc2h9YDtcbiAgY29uc3QgZm9ybSA9IGNyZWF0ZUZvcm0ocGF5bG9hZCk7XG4gIHJldHVybiBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlKFxuICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHtcbiAgICAgIHVybCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgZGF0YTogZm9ybSxcbiAgICAgIC8vIHJlc29sdmVCb2R5T25seTogdHJ1ZSxcbiAgICB9KVxuICApIGFzIEltZ3VyQXBpUmVzcG9uc2U8Ym9vbGVhbj47XG59XG4iLCJpbXBvcnQgeyBJbWd1ckNsaWVudCB9IGZyb20gJy4uL2NsaWVudCc7XG5pbXBvcnQge1xuICBjcmVhdGVGb3JtLFxuICBnZXRJbWd1ckFwaVJlc3BvbnNlRnJvbVJlc3BvbnNlLFxuICAvLyBnZXRTb3VyY2UsXG59IGZyb20gJy4uL2NvbW1vbi91dGlscyc7XG5pbXBvcnQgeyBQYXlsb2FkLCBJbWd1ckFwaVJlc3BvbnNlLCBJbWFnZURhdGEgfSBmcm9tICcuLi9jb21tb24vdHlwZXMnO1xuaW1wb3J0IHsgVVBMT0FEX0VORFBPSU5UIH0gZnJvbSAnLi4vY29tbW9uL2VuZHBvaW50cyc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGxvYWQoXG4gIGNsaWVudDogSW1ndXJDbGllbnQsXG4gIHBheWxvYWQ6IHN0cmluZyB8IHN0cmluZ1tdIHwgUGF5bG9hZCB8IFBheWxvYWRbXVxuKTogUHJvbWlzZTxJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT4gfCBJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT5bXT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShwYXlsb2FkKSkge1xuICAgIGNvbnN0IHByb21pc2VzID0gcGF5bG9hZC5tYXAoKHA6IHN0cmluZyB8IFBheWxvYWQpID0+IHtcbiAgICAgIGNvbnN0IGZvcm0gPSBjcmVhdGVGb3JtKHApO1xuXG4gICAgICAvKiBlc2xpbnQgbm8tYXN5bmMtcHJvbWlzZS1leGVjdXRvcjogMCAqL1xuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgICAgIHJlc29sdmUoXG4gICAgICAgICAgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShcbiAgICAgICAgICAgIGF3YWl0IGNsaWVudC5yZXF1ZXN0KHtcbiAgICAgICAgICAgICAgdXJsOiBVUExPQURfRU5EUE9JTlQsXG4gICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICBkYXRhOiBmb3JtLFxuICAgICAgICAgICAgICBvblVwbG9hZFByb2dyZXNzOiAocHJvZ3Jlc3NFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHsgcHJvZ3Jlc3NFdmVudCB9KTtcbiAgICAgICAgICAgICAgICBjbGllbnQuZW1pdCgndXBsb2FkUHJvZ3Jlc3MnLCB7IC4uLnByb2dyZXNzRXZlbnQgfSk7XG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICkgYXMgSW1ndXJBcGlSZXNwb25zZTxJbWFnZURhdGE+XG4gICAgICAgICk7XG4gICAgICB9KSBhcyBQcm9taXNlPEltZ3VyQXBpUmVzcG9uc2U8SW1hZ2VEYXRhPj47XG4gICAgfSk7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgfVxuXG4gIGNvbnN0IGZvcm0gPSBjcmVhdGVGb3JtKHBheWxvYWQpO1xuICAvLyBjb25zdCBpZCA9IERhdGUubm93LnRvU3RyaW5nKCk7XG4gIGNvbnN0IHJlcXVlc3QgPSBhd2FpdCBjbGllbnQucmVxdWVzdCh7XG4gICAgdXJsOiBVUExPQURfRU5EUE9JTlQsXG4gICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgZGF0YTogZm9ybSxcbiAgICBvblVwbG9hZFByb2dyZXNzOiAocHJvZ3Jlc3NFdmVudCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coeyBwcm9ncmVzc0V2ZW50IH0pO1xuICAgICAgY2xpZW50LmVtaXQoJ3VwbG9hZFByb2dyZXNzJywgeyAuLi5wcm9ncmVzc0V2ZW50IH0pO1xuICAgIH0sXG4gIH0pO1xuXG4gIHJldHVybiBQcm9taXNlLnJlc29sdmUoXG4gICAgZ2V0SW1ndXJBcGlSZXNwb25zZUZyb21SZXNwb25zZShyZXF1ZXN0KSBhcyBJbWd1ckFwaVJlc3BvbnNlPEltYWdlRGF0YT5cbiAgKTtcbn1cbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImF4aW9zXCIpOzsiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJldmVudHNcIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcImZvcm0tZGF0YVwiKTs7IiwibW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwidHNsaWJcIik7OyIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZShcInVybFwiKTs7IiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsImltcG9ydCB7IEltZ3VyQ2xpZW50IH0gZnJvbSAnLi9jbGllbnQnO1xuZXhwb3J0IHsgSW1ndXJDbGllbnQsIEltZ3VyQ3JlZGVudGlhbHMsIEltZ3VyQXBpUmVzcG9uc2UgfSBmcm9tICcuL2NsaWVudCc7XG5leHBvcnQgZGVmYXVsdCBJbWd1ckNsaWVudDtcbiJdLCJzb3VyY2VSb290IjoiIn0=